
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic numpy techniques &#8212; Coding for Machine Learning and Data Science</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Intermediate NumPy" href="02_lab2.html" />
    <link rel="prev" title="Practicals" href="../02_labs_front_page.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  
  <h1 class="site-logo" id="site-title">Coding for Machine Learning and Data Science</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../front_page.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Setup
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../001_setup/git.html">
   GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../001_setup/conda.html">
   Conda virtual environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../001_setup/docker.html">
   Docker
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Revision
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../002_basics/fp_lectures.html">
   Lectures
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../002_basics/lectures/Lecture1.html">
     Python Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../002_basics/lectures/Lecture2.html">
     Conditionals and Loops
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../002_basics/fp_practicals.html">
   Practicals
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../002_basics/labs/01_basics.html">
     Basic Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../002_basics/labs/debug1.html">
     Debug challenge 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../002_basics/labs/02_basics.html">
     Conditionals and Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../002_basics/labs/debug2.html">
     Debug challenge 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Part 1. Advanced Python
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../01_advanced_python/lecture/01_python_classes.html">
   Lecture: Class coding basics
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Part 2. NumPy
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02_lectures_front_page.html">
   Lecture notes
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/01_numpy_101.html">
     Basic
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/02_intermediate_numpy.html">
     Intermediate
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../02_labs_front_page.html">
   Practicals
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Basic
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
     techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_lab2.html">
     Intermediate NumPy
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02_debug_front_page.html">
   Debug challenges
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../debug_challenges/debug_challenge_2.html">
     Debug Challenge 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Part 3. Pandas and MatplotLib
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../03_pandas/03_lectures_front_page.html">
   Lecture notes
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../03_pandas/lectures/01_intro_pandas.html">
     Introduction to
     <strong>
      <code class="docutils literal notranslate">
       <span class="pre">
        pandas
       </span>
      </code>
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../03_pandas/lectures/01_intro_pandas.html#reading-data-into-pandas-from-a-flat-file">
     Reading data into pandas from a flat file
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../03_pandas/03_labs_front_page.html">
   Practicals
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../03_pandas/labs/nhs_synthetic_ed_download.html">
     Accessing large remote datasets
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/02_numpy/labs/02_lab1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/health-data-science-OR/coding-for-ml"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/health-data-science-OR/coding-for-ml/issues/new?title=Issue%20on%20page%20%2Fcontent/02_numpy/labs/02_lab1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/health-data-science-OR/coding-for-ml/main?urlpath=lab/tree/content/02_numpy/labs/02_lab1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/health-data-science-OR/coding-for-ml/blob/main/content/02_numpy/labs/02_lab1.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numpy-basics">
   NumPy Basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-create-numpy-arrays-and-accessing-data">
     Example 1: Create NumPy arrays and accessing data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-creating-empty-arrays">
     Example 2: Creating empty arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-manipulating-array-data">
     Example 3: Manipulating array data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1-create-and-manipulate-your-own-numpy-array">
     Exercise 1: Create and manipulate your own numpy array
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numpy-for-data-analysis">
   NumPy for data analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-basic-statistical-analysis-of-the-standard-normal">
     Example 1: Basic statistical analysis of the Standard Normal
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-simple-linear-regression-using-data-in-numpy-arrays">
     Example 2: Simple linear regression using data in numpy arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2-descriptive-analysis-of-hourly-banks-customers">
     Exercise 2: Descriptive analysis of hourly banks customers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3-before-and-after-analysis-of-stroke-treatment-rates">
     Exercise 3: Before and After Analysis of Stroke Treatment Rates
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#looping-over-numpy-arrays">
   Looping over NumPy Arrays
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-basic-iteration-over-an-array">
     Example 1: Basic Iteration over an array
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-finding-the-maximum-value-in-an-array">
     Example 2: Finding the maximum value in an array
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-vectorizing-a-function">
     Example 3: Vectorizing a function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-4-using-np-where-and-fancy-indexing">
     Example 4: Using np.where() and fancy indexing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4-calculate-the-winsorized-mean">
     Exercise 4: Calculate the winsorized mean
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#debug-challenge">
   Debug Challenge
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#challenge-1">
     Challenge 1:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#self-learning-challenge">
   Self learning challenge.
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="basic-numpy-techniques">
<h1>Basic <code class="docutils literal notranslate"><span class="pre">numpy</span></code> techniques<a class="headerlink" href="#basic-numpy-techniques" title="Permalink to this headline">¶</a></h1>
<p>This week we are going to learn about <strong>NumPy</strong> and manipulating 1D NumPy arrays.  There is also a <em>debug</em> challenge and a ‘<em>self learning</em>’ challenge at the end of the lab.</p>
<blockquote>
<div><p>The lab assumes you are using the <code class="docutils literal notranslate"><span class="pre">hds_code</span></code> conda virtual environment.</p>
<blockquote>
<div><p>You should have complete the <strong>NumPy 101</strong> lecture in the series before attempting this lab.</p>
</div></blockquote>
</div></blockquote>
<hr class="docutils" />
<p><strong>Remember for any code where you wish to use numpy you need to import it:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="numpy-basics">
<h2>NumPy Basics<a class="headerlink" href="#numpy-basics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-create-numpy-arrays-and-accessing-data">
<h3>Example 1: Create NumPy arrays and accessing data<a class="headerlink" href="#example-1-create-numpy-arrays-and-accessing-data" title="Permalink to this headline">¶</a></h3>
<p>The fundermental building block in NumPy is the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
<p>As we discovered in the last lecture arrays are quite different from a Python <code class="docutils literal notranslate"><span class="pre">List</span></code>.  However, creation and accessing individual array items and slicing array is very similar to a list.  A big difference is that a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> requires
all data values to be of the <strong>same type</strong>.</p>
<p>Suppose that we want a numpy array containing the integers 4, 3, 1, 5 and 6.</p>
<p>A simple way to create such an array and access its data is to use the following syntax.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;the array contains </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;a numpy array has has type </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;the array has a shape of </span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The item at index 0 in the array is </span><span class="si">{</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The item at index 2 in the array is </span><span class="si">{</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;If we slice the array between item 0 and 2 we get </span><span class="si">{</span><span class="n">arr</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;If we slice the array between item 3 and 5 we get </span><span class="si">{</span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the array contains [4 3 1 5 6]
a numpy array has has type [4 3 1 5 6]
the array has a shape of (5,)
The item at index 0 in the array is 4
The item at index 2 in the array is 1
If we slice the array between item 0 and 2 we get [4 3]
If we slice the array between item 3 and 5 we get [5 6]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-2-creating-empty-arrays">
<h3>Example 2: Creating empty arrays<a class="headerlink" href="#example-2-creating-empty-arrays" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The size of a NumPy array needs to be defined upfront.</p></li>
<li><p>You cannot dynamically append to a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> like you can with a <code class="docutils literal notranslate"><span class="pre">List</span></code></p></li>
<li><p>One option is to create an empty numpy array or a numpy array containing all zeros (if using numeric data).</p></li>
<li><p>When you create an ‘empty’ array you are allocated a space in the computer’s memory.</p></li>
<li><p>There may be some strange data in inside (note your output might look different to the below depending on what is in your computer’s memory)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">empty_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">empty_arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">empty_arr</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">empty_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.64364675e-310 0.00000000e+000 0.00000000e+000 0.00000000e+000
 0.00000000e+000 4.89020456e-033 1.14195470e-071 6.86770264e-091
 2.12644776e+160 4.57490964e-315]
&lt;class &#39;numpy.ndarray&#39;&gt;
(10,)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Alternatively you could create an array that contains all zeros</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeros_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zeros_arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">zeros_arr</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zeros_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
&lt;class &#39;numpy.ndarray&#39;&gt;
(10,)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-3-manipulating-array-data">
<h3>Example 3: Manipulating array data<a class="headerlink" href="#example-3-manipulating-array-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>It is trivial to update individual elements in an array</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;original data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">111</span>
<span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">222</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;updated data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original data [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
updated data [  0.   0.   0.   0.   0. 111.   0.   0.   0. 222.]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>When you slice an array you effectively create a <strong>view</strong> of the data.</p></li>
<li><p>This means that when you update the slice you update the original array as well.</p></li>
<li><p>Numpy keeps the data in the same place in memory for efficiency.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;original data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># slice from index 3 to index 5</span>
<span class="n">slice_of_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> 
<span class="c1">#incremement each value in the slice by 999</span>
<span class="n">slice_of_data</span> <span class="o">+=</span> <span class="mi">999</span> 

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;slice of data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;the original data is also updated </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original data [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
slice of data [  0.   0.   0. 999. 999. 999.   0.   0.   0.   0.]
the original data is also updated [  0.   0.   0. 999. 999. 999.   0.   0.   0.   0.]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>NumPy makes basic matrix alegbra simple and efficient</p></li>
<li><p>Here we are going to work with 2 arrays of the same size.</p></li>
<li><p>We are going to create a sequence of numbers in each using the <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> function</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#create a sequence of integers 0-9</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#create a sequence of integers 10-19</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data1: </span><span class="si">{</span><span class="n">data1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data2: </span><span class="si">{</span><span class="n">data2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The square of each value in data1 </span><span class="si">{</span><span class="n">data1</span><span class="o">**</span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The summation of the the two arrays </span><span class="si">{</span><span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The difference between the the two arrays </span><span class="si">{</span><span class="n">data1</span> <span class="o">-</span> <span class="n">data2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">data1</span> <span class="o">+=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;If we add 10 to each element in data1 we get </span><span class="si">{</span><span class="n">data1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data1: [0 1 2 3 4 5 6 7 8 9]
data2: [10 11 12 13 14 15 16 17 18 19]
The square of each value in data1 [ 0  1  4  9 16 25 36 49 64 81]
The summation of the the two arrays [10 12 14 16 18 20 22 24 26 28]
The difference between the the two arrays [-10 -10 -10 -10 -10 -10 -10 -10 -10 -10]
If we add 10 to each element in data1 we get [10 11 12 13 14 15 16 17 18 19]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-1-create-and-manipulate-your-own-numpy-array">
<h3>Exercise 1: Create and manipulate your own numpy array<a class="headerlink" href="#exercise-1-create-and-manipulate-your-own-numpy-array" title="Permalink to this headline">¶</a></h3>
<p><strong>Task:</strong></p>
<ul class="simple">
<li><p>Create two numpy arrays of size 10.</p></li>
<li><p>The first array should be called <code class="docutils literal notranslate"><span class="pre">array_1</span></code> have all zero values</p></li>
<li><p>The second array <code class="docutils literal notranslate"><span class="pre">array_2</span></code> should be a sequence from 90 to 99</p></li>
<li><p>Create a slice of <code class="docutils literal notranslate"><span class="pre">array_1</span></code> to access the last 5 elements of the array.</p></li>
<li><p>Add the value 10 to each of these slices</p></li>
<li><p>Now multiply the two arrays together and print out the result</p></li>
</ul>
<p>The expected result is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">950</span><span class="p">,</span> <span class="mi">960</span><span class="p">,</span> <span class="mi">970</span><span class="p">,</span> <span class="mi">980</span><span class="p">,</span> <span class="mi">990</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="numpy-for-data-analysis">
<h2>NumPy for data analysis<a class="headerlink" href="#numpy-for-data-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-basic-statistical-analysis-of-the-standard-normal">
<h3>Example 1: Basic statistical analysis of the Standard Normal<a class="headerlink" href="#example-1-basic-statistical-analysis-of-the-standard-normal" title="Permalink to this headline">¶</a></h3>
<p>We are going to explore the basic analysis capabilities of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>The first thing we will do is generate a synthetic dataset.  We are going to take 10,000 random samples from the standard normal distribution.  <code class="docutils literal notranslate"><span class="pre">numpy.random</span></code> has a function to do this called <code class="docutils literal notranslate"><span class="pre">randn</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10000,)
&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We are then going to create a function to conduct and report a descriptive analysis of our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">descriptives</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns mean, stdev, and 1st and 99th </span>
<span class="sd">    percentile of a 1D numpy.array</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    data: numpy.ndarray </span>
<span class="sd">        1D array containing data to analyse</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">        tuple with 4 items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">per_1st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
    <span class="n">per_99th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">per_1st</span><span class="p">,</span> <span class="n">per_99th</span>


<span class="n">results</span> <span class="o">=</span> <span class="n">descriptives</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.013684817675242999, 1.0103986712581512, -2.352484609722259, 2.324202919987072)
</pre></div>
</div>
</div>
</div>
<p>So we can see that the mean of the distribution is approx zero with a standard deviation of 1.</p>
<p>We can also see that 99% of our data lie between -2.3 and +2.3 (which we would expect from the standard normal)</p>
<p>It is very simple to work with NumPy arrays containing numeric data.  For example if we wanted to find all of our samples that are greater than or equal to +2.3 we use:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&gt;=</span> <span class="mf">2.3</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10000,)
&lt;class &#39;numpy.ndarray&#39;&gt;
[False False False ... False False False]
</pre></div>
</div>
</div>
</div>
<p>The code returns a new <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> that contains boolean (True/False) values.  The value at array index <code class="docutils literal notranslate"><span class="pre">i</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> if the corresponding value at index <code class="docutils literal notranslate"><span class="pre">i</span></code> in array <code class="docutils literal notranslate"><span class="pre">data</span></code> is &gt;= 2.3 and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.  If we had used a python <code class="docutils literal notranslate"><span class="pre">List</span></code> we would have needed to loop through all of list items and perform the check ourselves.</p>
<p>Let’s create some generalised functions to return the probabilities that a value is greater or less than a user specified value in our data set.</p>
<p>To do that we need to know that</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span> <span class="o">==</span> <span class="mi">0</span>
<span class="kc">True</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Therefore we can take the sum of our boolean array to find out how many array elements are greater or less than a user specified values e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="mf">2.3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prob_great_than_or_equal_to</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the proportion of the dataset that</span>
<span class="sd">    is greater than or equal to x</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    data: numpy.ndarray </span>
<span class="sd">        Vector containing numeric data</span>
<span class="sd">    x: float</span>
<span class="sd">        Function returns proportion where data &gt;=x</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    float</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">prob_less_than_or_equal_to</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the proportion of the dataset that</span>
<span class="sd">    is less than or equal to x</span>
<span class="sd">    </span>
<span class="sd">    Keyword arguments</span>
<span class="sd">    data -- a numpy.ndarray containing numeric data</span>
<span class="sd">    x -- a numeric value. Function returns proportion where data &lt;=x</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">prob_great_than_or_equal_to</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">prob_less_than_or_equal_to</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.96</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0254 0.0265
</pre></div>
</div>
</div>
</div>
<p>Our test of these functions shows use that around 95% of data lie between points -1.96 and +1.96 (which again we would expect with the standard normal).</p>
</div>
<div class="section" id="example-2-simple-linear-regression-using-data-in-numpy-arrays">
<h3>Example 2: Simple linear regression using data in numpy arrays<a class="headerlink" href="#example-2-simple-linear-regression-using-data-in-numpy-arrays" title="Permalink to this headline">¶</a></h3>
<p>NumPy arrays are the fundamental building block of the Python SciPy stack.
Scientific computing in Python nearly always makes use of <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> at some level.</p>
<p>In this example we will load two NumPy arrays from file and conduct a simple linear regression.  The method of Ordinary Least Squares is used to fit a linear model (think <span class="math notranslate nohighlight">\(y = \beta_1 x + \beta_0 + \epsilon \)</span> ) to some data stored in numpy arrays.</p>
<p>We have two datasets.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">breach.csv</span></code>: monthly totals of people waiting 4 or more hours in English emergency departments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtocs.csv</span></code>: monthly total of the number of people waiting to be discharged (leave) hospial and go home or transfer to another form of healthcare.</p></li>
</ul>
<p>We are going to (naively) assess the relationship between these two variables.  For the purposes of this example we are going to ignore that these two datasets are time-series data.</p>
<p>The library we will use to conduct linear regression is <code class="docutils literal notranslate"><span class="pre">statsmodels.api</span></code>
We will use the function <code class="docutils literal notranslate"><span class="pre">OLS</span></code> which accepts two keyword arguments: y and x</p>
<p>Once we have conducted the analysis we will print the results summary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#OLS functionality is in statsmodels</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>  

<span class="k">def</span> <span class="nf">load_dtoc_dataset</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Loads the breach and dtoc data sets into memory</span>
<span class="sd">    Returns a tuple of numpy.ndarrays representing</span>
<span class="sd">    breach and dtoc dataset respectively.</span>
<span class="sd">    &#39;&#39;&#39;</span>    
    <span class="c1">#note we use skip_header because the dataset has column descriptors</span>
    <span class="n">dtoc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;./data/dtocs.csv&#39;</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
    <span class="n">breach</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;./data/breach.csv&#39;</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">breach</span><span class="p">,</span> <span class="n">dtoc</span>
    
    
<span class="n">breach</span><span class="p">,</span> <span class="n">dtoc</span> <span class="o">=</span> <span class="n">load_dtoc_dataset</span><span class="p">()</span>

<span class="c1">#regression code</span>
<span class="n">dtoc</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">dtoc</span><span class="p">)</span> <span class="c1"># an intercept term to the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">breach</span><span class="p">,</span> <span class="n">dtoc</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                      y   R-squared:                       0.714
Model:                            OLS   Adj. R-squared:                  0.710
Method:                 Least Squares   F-statistic:                     194.6
Date:                Thu, 11 Mar 2021   Prob (F-statistic):           6.80e-23
Time:                        14:16:20   Log-Likelihood:                -945.02
No. Observations:                  80   AIC:                             1894.
Df Residuals:                      78   BIC:                             1899.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const      -1.633e+05      2e+04     -8.178      0.000   -2.03e+05   -1.24e+05
x1            57.7282      4.138     13.950      0.000      49.489      65.967
==============================================================================
Omnibus:                       11.472   Durbin-Watson:                   0.888
Prob(Omnibus):                  0.003   Jarque-Bera (JB):               16.361
Skew:                           0.591   Prob(JB):                     0.000280
Kurtosis:                       4.874   Cond. No.                     2.61e+04
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.61e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The results of regression analysis gives an adjusted R-squared of 0.71</p></li>
<li><p>Both the intercept (cont) and dtocs (x1) have confidence intervals that do not include zero</p></li>
<li><p>Our analysis suggests that (on the face of it) there is an association between the two variables</p></li>
</ul>
</div>
<div class="section" id="exercise-2-descriptive-analysis-of-hourly-banks-customers">
<h3>Exercise 2: Descriptive analysis of hourly banks customers<a class="headerlink" href="#exercise-2-descriptive-analysis-of-hourly-banks-customers" title="Permalink to this headline">¶</a></h3>
<p>The dataset <code class="docutils literal notranslate"><span class="pre">data/bank_arrivals.csv</span></code> contains 1000 hourly observations of customers arriving at a bank cashiers queue.</p>
<ul class="simple">
<li><p>Load the bank arrivals from the file into a numpy array</p></li>
<li><p>Check that you have successfully loaded all 1000 observations</p></li>
<li><p>Create a function <code class="docutils literal notranslate"><span class="pre">descriptives</span></code> that accepts an numpy array as an argument.</p></li>
<li><p>The function should calculate and return the mean, standard deviation, median and inter-quartile range</p></li>
<li><p><strong>Tip</strong>: The inter-quartile range is the difference between the 75th and 25th percentile; the median is the 50th percentile.</p></li>
<li><p>Calculate the mean, standard deviation, median and inter-quartile range for bank arrivals data</p></li>
<li><p>Print the summary statistics to the console.</p></li>
</ul>
</div>
<div class="section" id="exercise-3-before-and-after-analysis-of-stroke-treatment-rates">
<h3>Exercise 3: Before and After Analysis of Stroke Treatment Rates<a class="headerlink" href="#exercise-3-before-and-after-analysis-of-stroke-treatment-rates" title="Permalink to this headline">¶</a></h3>
<p>The file <code class="docutils literal notranslate"><span class="pre">data/lysis.csv</span></code> contains a monthly proportion of a hospital’s stroke patients that have been treated with a potentially life saving drug to remove a blood clot from their brain.</p>
<p>There are a total of 54 months in the dataset.</p>
<p>In month 42 the hospital introduced a new process for fast tracking patients to treatment.  Your task is to quantify the difference in treatment rates before and after the fast track intervention and to determine if the result is statistically significant.</p>
<p>To do this you need to:</p>
<ul class="simple">
<li><p>import the OLS function from <code class="docutils literal notranslate"><span class="pre">statsmodels.api</span></code></p></li>
<li><p>Read the <code class="docutils literal notranslate"><span class="pre">lysis.csv</span></code> file into a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> variable (hint: watch out for headers in the file)</p></li>
<li><p>Create a numpy array that is the same size as the lysis array. It should contain zero when it the month (index) is less than when the intervention was introduced (42) and 1 for all months after the intervention was introduced.  Your array should look like</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dummy</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> 

<span class="c1"># Hints:</span>
<span class="c1"># dummy.shape[0] == 54;  (i.e. its length is 54)</span>
<span class="c1"># where index &lt; 42 dummy[index] = 0; where index &gt;=42 dummy[index] == 1</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Conduct a regression analysis of the before and after period and display the results.</p></li>
<li><p>Tip: remember that the regression analysis should include a constant term.</p></li>
<li><p>The independent variables in your regression is the dummy variable</p></li>
<li><p>The dependent variables in your regression is the data read in from <code class="docutils literal notranslate"><span class="pre">lysis.csv</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="looping-over-numpy-arrays">
<h2>Looping over NumPy Arrays<a class="headerlink" href="#looping-over-numpy-arrays" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-basic-iteration-over-an-array">
<h3>Example 1: Basic Iteration over an array<a class="headerlink" href="#example-1-basic-iteration-over-an-array" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>For a 1D <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> you can iterate (loop) over each element much in the same way you would iterate over items in a <code class="docutils literal notranslate"><span class="pre">List</span></code></p></li>
<li><p>Here we create an array with 10 items - the numbers 0 to 9.</p></li>
<li><p>We then iterate over each item using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 1 2 3 4 5 6 7 8 9 
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Alternatively a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and array index approach could be used</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 1 2 3 4 5 6 7 8 9 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-2-finding-the-maximum-value-in-an-array">
<h3>Example 2: Finding the maximum value in an array<a class="headerlink" href="#example-2-finding-the-maximum-value-in-an-array" title="Permalink to this headline">¶</a></h3>
<p>A simple example of a loop is finding the maximum value in an array.  This works in a similar fashion to when
using a python <code class="docutils literal notranslate"><span class="pre">List</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">max_value</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Loop over each element in array</span>
<span class="sd">    and return the maximum value</span>
<span class="sd">    </span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    data -- numpy.array containing numeric data</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">max_value</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">max_value</span>
        
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_value</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000
</pre></div>
</div>
</div>
</div>
<p>Note that in practice you would use numpy’s build-it function for max as opposed to writing your own code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="example-3-vectorizing-a-function">
<h3>Example 3: Vectorizing a function<a class="headerlink" href="#example-3-vectorizing-a-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>NumPy allows you to vectorize a function.</p></li>
<li><p>This means that you can apply a function to every item in an array without requiring an explicit <code class="docutils literal notranslate"><span class="pre">for</span></code> loop in your code.</p></li>
</ul>
<p>As an example consider the following array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

</pre></div>
</div>
<p>If we wanted to limit the values in this array to a maximum value of 5 then one way to do this is to use an explicit <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to iterate over all of the elements and impose a ceiling on the value.  I.e.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ceiling</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Loop through all elements of a np.ndarray</span>
<span class="sd">    and impose a max_value ceiling on the data.</span>
<span class="sd">    </span>
<span class="sd">    Keyword arguments:</span>
<span class="sd">    arry - numeric np.ndarray to iterate</span>
<span class="sd">    upper_limit - the numeric upper limit on values in arr</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">upper_limit</span><span class="p">)</span>
        
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;original data: </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">ceiling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;data with ceiling </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original data: [0 1 2 3 4 5 6 7 8 9]
data with ceiling [0 1 2 3 4 5 5 5 5 5]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>However, with NumPy we could instead make use of the <code class="docutils literal notranslate"><span class="pre">np.vectorize()</span></code> function</p></li>
<li><p>To make it work we need to update the <code class="docutils literal notranslate"><span class="pre">ceiling</span></code> function so that it works on individual array elements</p></li>
<li><p>This means that we no longer have a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop in our code!</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ceiling</span><span class="p">(</span><span class="n">to_test</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returing the minimum value by comparing to_test to upper_limit</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    to_test: float</span>
<span class="sd">        numeric value to test if breaches ceiling</span>
<span class="sd">    </span>
<span class="sd">    upper_limit: float</span>
<span class="sd">        the numeric upper limit on to_test</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">to_test</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">)</span>

<span class="c1"># v_ceiling is a wrapper function that we call instead of ceiling</span>
<span class="n">v_ceiling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">ceiling</span><span class="p">)</span>  

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">c_data</span> <span class="o">=</span> <span class="n">v_ceiling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;original data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data with ceiling </span><span class="si">{</span><span class="n">c_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original data: [0 1 2 3 4 5 6 7 8 9]
data with ceiling [0 1 2 3 4 5 5 5 5 5]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>In this simple example the function <code class="docutils literal notranslate"><span class="pre">ceiling</span></code> is just a wrapper for the the built in function <code class="docutils literal notranslate"><span class="pre">min</span></code></p></li>
<li><p>Therefore we could vectorize <code class="docutils literal notranslate"><span class="pre">min</span></code> instead.</p></li>
<li><p>This means we need even less code again!</p></li>
<li><p>In reality you are more likely to vectorize your own custom functions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we vectorize min instead of our custom function</span>
<span class="n">v_ceiling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span>  

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">c_data</span> <span class="o">=</span> <span class="n">v_ceiling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;original data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data with ceiling </span><span class="si">{</span><span class="n">c_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original data: [0 1 2 3 4 5 6 7 8 9]
data with ceiling [0 1 2 3 4 5 5 5 5 5]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-4-using-np-where-and-fancy-indexing">
<h3>Example 4: Using np.where() and fancy indexing<a class="headerlink" href="#example-4-using-np-where-and-fancy-indexing" title="Permalink to this headline">¶</a></h3>
<p>Another efficient alternative to using a loop in NumPy is to use <code class="docutils literal notranslate"><span class="pre">np.where()</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">np.where()</span></code> is like asking “tell me where in this array, values satisfy a given condition”.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([3, 4]),)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">results</span></code> above tell us that the array <code class="docutils literal notranslate"><span class="pre">data</span></code> contains values that are &gt; 3 in indexes 3 and 4</p></li>
<li><p>This might be a useful result on its own.</p></li>
<li><p>To go one step further and access and manipulate the values in indexes 3 and 4 we need to use fancy indexing</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">sliced_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sliced_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  1 500 700]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The code above demonstrates fancy indexing.</p></li>
<li><p>We defined a <code class="docutils literal notranslate"><span class="pre">List</span></code> of indexes i.e. <code class="docutils literal notranslate"><span class="pre">indexes</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">4]</span></code> (this could also be another <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>)</p></li>
<li><p>The code <code class="docutils literal notranslate"><span class="pre">data[indexes]</span></code> ‘looks up’ the values contained in indexes 1, 3, and 4 of the array <code class="docutils literal notranslate"><span class="pre">data</span></code></p></li>
<li><p>If we combine using <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> and ‘fancy indexing’ we have very powerful code</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>
<span class="n">sliced_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sliced_data</span><span class="p">)</span>

<span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">999</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[500 700]
[  0   1   2 999 999]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>We can implement the <code class="docutils literal notranslate"><span class="pre">ceiling</span></code> function from the previous example using np.where()</p></li>
<li><p>It is neat solution that requires minimal code</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ceiling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">upper_limit</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returing the minimum value by comparing to_test to upper_limit</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    to_test: float</span>
<span class="sd">        numeric value to test if breaches ceiling</span>
<span class="sd">    </span>
<span class="sd">    upper_limit: float</span>
<span class="sd">        the numeric upper limit on to_test</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">upper_limit</span><span class="p">)]</span> <span class="o">=</span> <span class="n">upper_limit</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;original data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ceiling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data with ceiling </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original data: [0 1 2 3 4 5 6 7 8 9]
data with ceiling [0 1 2 3 4 5 5 5 5 5]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-4-calculate-the-winsorized-mean">
<h3>Exercise 4: Calculate the winsorized mean<a class="headerlink" href="#exercise-4-calculate-the-winsorized-mean" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Assume you have the data</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The 20% Winsorized mean of <code class="docutils literal notranslate"><span class="pre">data</span></code> is calculated on a modified data set where the top and bottom 10% of values are replaced by the 10th and 90th percentiles.</p></li>
<li><p>In this case the 10th percentile = 2 and the 90th = 10.  Therefore the winsorized dataset is:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">win_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">win_mean</span> <span class="o">=</span> <span class="n">win_data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Write a function <code class="docutils literal notranslate"><span class="pre">winsorise(data,</span> <span class="pre">cut_off=0.1)</span></code></p></li>
<li><p>The function must modify the numeric np.ndarray <code class="docutils literal notranslate"><span class="pre">data</span></code> so that is it is winsorised.</p></li>
<li><p>A cut_off = 0.1 specifies that the function uses the 10th and 90th percentiles as cut-offs</p></li>
</ul>
<p>Hints:</p>
<ul class="simple">
<li><p>There are multiple ways to solve this problem</p>
<ul>
<li><p>You could use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop</p></li>
<li><p>You could create a function that is vectorized using <code class="docutils literal notranslate"><span class="pre">np.vectorize()</span></code></p></li>
<li><p>You could use <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> and fancy indexing</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="debug-challenge">
<h2>Debug Challenge<a class="headerlink" href="#debug-challenge" title="Permalink to this headline">¶</a></h2>
<p>Each laboratory has a debug challenge.  You will be given a pre-existing script containing Python code. The catch is that the code doesn’t run!</p>
<p>Your challenge is to find and correct the errors so that the script correctly executes.</p>
<p>The challenges are based around common problems students have when writing code.  If you do the exercises it will help you debug your own code and maybe even avoid the mistakes in the first place!</p>
<div class="section" id="challenge-1">
<h3>Challenge 1:<a class="headerlink" href="#challenge-1" title="Permalink to this headline">¶</a></h3>
<p>This weeks debug challenge is fixing a monte-carlo simulation model.</p>
<p>We return to our stroke care example from earlier in the lab.  This time rather than conducting
an empricial analysis we are going to model each stage of the emeregency stroke care pathway
and examine the distribution of performance that might be expected.</p>
<p>The model is a simplification of a stroke treatment pathway at a hospital.<br />
Patients must be treated within 180 minutes of the onset of their symptoms.</p>
<ul class="simple">
<li><p>They must be brought to hospital</p></li>
<li><p>be seen in the ED</p></li>
<li><p>undergo a CT scan</p></li>
<li><p>be clinically assessed by a stroke medic</p></li>
<li><p>not have any additional illnesses that prevent treatment</p></li>
</ul>
<p>Instructions:</p>
<ul class="simple">
<li><p>open <code class="docutils literal notranslate"><span class="pre">wk3_debug_challenge.py</span></code> in <code class="docutils literal notranslate"><span class="pre">spyder</span></code>.</p></li>
<li><p>Attempt to run the code.  The code will raise errors.</p></li>
<li><p>Fix the bugs!</p></li>
</ul>
<p>Hints:</p>
<ul class="simple">
<li><p>Read the Python interpreter output.</p></li>
<li><p>The errors reported can look confusing at first, but read them carefully and they will point you to the lines of code with problems.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Spyder</span></code> IDE may give you some hints about formatting errors</p></li>
<li><p>It can be useful to use <code class="docutils literal notranslate"><span class="pre">print()</span></code> to display intermediate calculations and variable values.</p></li>
<li><p>Remember that <code class="docutils literal notranslate"><span class="pre">Spyder</span></code> has a variable viewer where you can look at the value of all variables created.</p></li>
<li><p>There might be multiple bugs!  When you fix one and try to run the code you might find another!</p></li>
</ul>
</div>
</div>
<div class="section" id="self-learning-challenge">
<h2>Self learning challenge.<a class="headerlink" href="#self-learning-challenge" title="Permalink to this headline">¶</a></h2>
<p><strong>Preprocessing data to detrend a timeseries</strong></p>
<p>In example 2, we conducted a simple linear regression to assess the relationship between two variables.  Our initial analysis is problematic because both variables are time series and contain autocorrelation and trend.  This means that we violate some of the assumptions of ordinary least squares regression and our estimates of the relationship are likely to be incorrect.</p>
<p>In practice, we would pre-process the data in the numpy arrays before conducting the regression.  A simple way to do this is to take the first difference of the time series. If <span class="math notranslate nohighlight">\(Y_t\)</span> represents the value of the time series at time <span class="math notranslate nohighlight">\(t\)</span> then the first difference is equal to:</p>
<div class="math notranslate nohighlight">
\[Y_t = Y_{t+1} - Y_t\]</div>
<p><strong>Tip</strong>:  If an array <span class="math notranslate nohighlight">\(a\)</span> has length <span class="math notranslate nohighlight">\(n\)</span> then an array of the first differences of <span class="math notranslate nohighlight">\(a\)</span> is <span class="math notranslate nohighlight">\(n-1\)</span></p>
<p><strong>Task</strong>:</p>
<ul class="simple">
<li><p>Copy the code from Example 2.</p></li>
<li><p>Modify the code to take the first difference of the breach and dtoc numpy arrays</p></li>
<li><p>Conduct the regression analysis using the first differences (detrended data)</p></li>
<li><p>Look at the new <span class="math notranslate nohighlight">\(R^2\)</span>.  Is there still strong evidence of a relationship?</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "health-data-science-OR/coding-for-ml",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/02_numpy/labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../02_labs_front_page.html" title="previous page">Practicals</a>
    <a class='right-next' id="next-link" href="02_lab2.html" title="next page">Intermediate NumPy</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Thomas Monks<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>