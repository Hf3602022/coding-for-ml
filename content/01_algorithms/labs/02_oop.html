
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OOP: A computer simulation example &#8212; Python for health data science.</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Lecture notes" href="../../02_numpy/02_lectures_front_page.html" />
    <link rel="prev" title="An introduction to OOP" href="../lecture/01_python_classes.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/title_cropped.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python for health data science.</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../front_page.html">
   Preface
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Setup
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../001_setup/git.html">
   GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../001_setup/conda.html">
   Conda virtual environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../001_setup/docker.html">
   Docker
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Algorithms and modelling
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_refresher_problems.html">
   Coding algorithms - solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lecture/01_python_classes.html">
   An introduction to OOP
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   OOP: A computer simulation example
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Part 2. NumPy
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../02_numpy/02_lectures_front_page.html">
   Lecture notes
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_numpy/lectures/01_numpy_101.html">
     Basic
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_numpy/lectures/02_intermediate_numpy.html">
     Intermediate
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../02_numpy/02_labs_front_page.html">
   Practicals
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_numpy/labs/02_lab1.html">
     Basic
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
     techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_numpy/labs/02_lab2.html">
     Intermediate NumPy
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../02_numpy/02_debug_front_page.html">
   Debug challenges
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../02_numpy/debug_challenges/debug_challenge_2.html">
     Debug Challenge 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Part 3. Statistical Programming
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../03_pandas/03_lectures_front_page.html">
   Lecture notes
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../03_pandas/lectures/01_intro_pandas.html">
     Introduction to
     <strong>
      <code class="docutils literal notranslate">
       <span class="pre">
        pandas
       </span>
      </code>
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../03_pandas/lectures/01_intro_pandas.html#reading-data-into-pandas-from-a-flat-file">
     Reading data into pandas from a flat file
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../03_pandas/03_labs_front_page.html">
   Practicals
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../03_pandas/labs/nhs_synthetic_ed_download.html">
     Accessing large remote datasets
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendix -Basic Python
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../appendix/fp_lectures.html">
   Lectures
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/lectures/Lecture1.html">
     Python Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/lectures/Lecture2.html">
     Conditionals and Loops
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../appendix/fp_practicals.html">
   Practicals
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/labs/01_basics.html">
     Basic Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/labs/debug1.html">
     Debug challenge 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/labs/02_basics.html">
     Conditionals and Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/labs/debug2.html">
     Debug challenge 2
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/01_algorithms/labs/02_oop.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/health-data-science-OR/coding-for-ml"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/health-data-science-OR/coding-for-ml/issues/new?title=Issue%20on%20page%20%2Fcontent/01_algorithms/labs/02_oop.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/health-data-science-OR/coding-for-ml/main?urlpath=lab/tree/content/01_algorithms/labs/02_oop.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/health-data-science-OR/coding-for-ml/blob/main/content/01_algorithms/labs/02_oop.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coding-problem-oh-data-scientists-can-t-you-all-just-get-along">
   Coding Problem: ‘Oh data scientists - can’t you all just get along!’
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#designing-your-code">
   Designing your code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agents">
     Agents
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#environment">
     Environment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-main-loop">
     The main loop
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coding-the-abs-using-oop-techniques">
   Coding the ABS using OOP techniques
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constants-and-default-parameter-values">
     Constants and default parameter values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-datascientist-class">
   The
   <code class="docutils literal notranslate">
    <span class="pre">
     DataScientist
    </span>
   </code>
   class
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="oop-a-computer-simulation-example">
<h1>OOP: A computer simulation example<a class="headerlink" href="#oop-a-computer-simulation-example" title="Permalink to this headline">¶</a></h1>
<p>As you have learned, Python is an <strong>Object Orientated Progamming (OOP) language</strong>.  We can follow the standard paradigm of OOP in python by creating <strong>classes</strong> and then instantiating an instance of the class called an <strong>object</strong>.  A class offers a higher level of abstraction for your code than functions alone.  One of the key benefits for data science is that you can design your algorithms to be resuable and composed from multiple classes.</p>
<p><strong>In this section you will learn:</strong></p>
<ul class="simple">
<li><p>How to do define a class in Python</p></li>
<li><p>Apply basic object orientated techniques to build an agent based simulation.</p></li>
</ul>
<blockquote>
<div><p>To help visualise our problem we are going to use a package called <strong>MatPlotLib</strong>.  We will cover this in detail later, but for now you just need to know that it allows us to create charts from our data.  The code is provided.</p>
</div></blockquote>
<hr class="docutils" />
<div class="section" id="coding-problem-oh-data-scientists-can-t-you-all-just-get-along">
<h2>Coding Problem: ‘Oh data scientists - can’t you all just get along!’<a class="headerlink" href="#coding-problem-oh-data-scientists-can-t-you-all-just-get-along" title="Permalink to this headline">¶</a></h2>
<p>To learn the basics of OOP you will create an <strong>Agent Based Simulation</strong> (ABS).  ABS is a popular methodology in data science for modelling emergent behaviour when a group of simple <strong>agents</strong> interact with each other within an <strong>environment</strong>.  Agents can be thought of an object with state and behaviour.  That lends itself nicely to the concept of a class from OOP. The concept of emergence is important in ABS as we are not coding the outcome of the modelling.  We are instead coding some behavioural interaction rules between the agents and exploring what happens when we run the model and set the agents loose.</p>
<blockquote>
<div><p>A full treatment ABS is out of scope for this course, but it is used a lot in health data science. You may have seen a number of ABS models used to model the epidemiology of COVID-19.</p>
</div></blockquote>
<p><strong>Here’s a description of our problem:</strong></p>
<ul class="simple">
<li><p>Data scientists live in a 2 dimensional gridword. That is a (n X m) grid of cells.  Each cell can only be inhabited by a single data scientist.</p></li>
<li><p>In grid world data scientists either favour Python or R.</p></li>
<li><p>A Data Scientist has a similarity threshold where they desire a % of their neighbours to code in their favourite language too!</p></li>
<li><p>If the agents neighbours are not similar enough the data scientist becomes unhappy and moves to a random empty location in the world!</p></li>
<li><p>The simulation will run for a maximum number of iterations.  If all agents are happy in any iteration then the simulation terminates early.</p></li>
<li><p>Agents make decisions about moving based on the state of the environment in the current iteration.  That is they have no knowledge if other data scientists are happy or unhappy.</p></li>
</ul>
<blockquote>
<div><p>This problem is actually a classic ABS modelling study by Schelling that studied the dynamics of segregation in populations.</p>
</div></blockquote>
</div>
<div class="section" id="designing-your-code">
<h2>Designing your code<a class="headerlink" href="#designing-your-code" title="Permalink to this headline">¶</a></h2>
<p>Before you write any code take a momemt to think about what the basic class structure of your code might look like.</p>
<div class="section" id="agents">
<h3>Agents<a class="headerlink" href="#agents" title="Permalink to this headline">¶</a></h3>
<p>The most obvious class we could include represents an <strong>Agent</strong>.  In some applications, you may want multiple types of agent class, but here their general behaviour is the same i.e. they become unhappy when they are not surrounded by enough of their fellow coding peers.  So here we you can simply define a single agent class and give it the attribute <code class="docutils literal notranslate"><span class="pre">language</span></code> of type <code class="docutils literal notranslate"><span class="pre">str</span></code> that determines the agents preference for Python or R.</p>
<p>Remember that in the simulation we will be creating multiple objects of type <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code>.  This is your <strong>population</strong>.  The skeleton code for <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code>.</p>
<blockquote>
<div><p>Reminder: we have overloaded the <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method when creating an instance of <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code>.  This is used to <strong>parameterise</strong> the agent.  Here we pass in a unique id, the coordinates in gridworld, the prefered coding language, the environment and the similarity threshold.</p>
</div></blockquote>
<p>The method <code class="docutils literal notranslate"><span class="pre">is_unsatisified_with_neighbours</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code> when an agent is unhappy with similarity of its neighbours in a grid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DataScientist</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unqiue_id</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">is_unsatisified_with_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="environment">
<h3>Environment<a class="headerlink" href="#environment" title="Permalink to this headline">¶</a></h3>
<p>After agents the decision making about what classes to include becomes a bit more fuzzy.  You could code the whole simulation to work with a single agent class and complete the rest using functions.  However, an environment object is a useful level of abstraction when creating a framework for running your model.  The code will also be much more readable.  Another benefit is that in a more complicated problem you might need to include multiple environments type classes (e.g. hospitals containing agents).</p>
<p>Here you will define a class called <code class="docutils literal notranslate"><span class="pre">GridWorld</span></code> that contains a population of <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code> objects.  We will take a look how these agents are stored internally shortly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GridWorld</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">n_empty</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">get_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">relocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-main-loop">
<h3>The main loop<a class="headerlink" href="#the-main-loop" title="Permalink to this headline">¶</a></h3>
<p>The simulation consists of a main loop that either runs for a maximum number of iterations or terminates early if all agents are happy.  Again you could just implement this as a function.  However, you may want to explore multiple <strong>scenarios</strong> with the model.  A scenario for example might explore a different similarity thresholds or ration of ‘Python’ coders to ‘R’ coders (for example what happens in a world where all all coders use Python and none use R!?).  For this reason you will create a simple <code class="docutils literal notranslate"><span class="pre">Model</span></code> class.  This will include a <code class="docutils literal notranslate"><span class="pre">run()</span></code> method that will start the main loop and the simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environment</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="coding-the-abs-using-oop-techniques">
<h2>Coding the ABS using OOP techniques<a class="headerlink" href="#coding-the-abs-using-oop-techniques" title="Permalink to this headline">¶</a></h2>
<div class="section" id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h3>
<p>You will mostly be using standard python in this example, but you will also make use of the following classes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">itertools</span></code>: we will use the <code class="docutils literal notranslate"><span class="pre">product</span></code> function to help use quickly generate a large number of coordinate pairs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">random</span></code>: the movement of agents in gridworld is stochastic.  We use the the <code class="docutils literal notranslate"><span class="pre">choice</span></code> function to select a random location for movement of unhappy agents.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time</span></code>: for fun we will time our code to see how long it take to execute a model (using the imaginitiviely titled <code class="docutils literal notranslate"><span class="pre">time.time()</span></code> function.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplolib.pyplot</span></code>: used to plot a gridworld.  We will use circles of different colours to represent agents.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="constants-and-default-parameter-values">
<h3>Constants and default parameter values<a class="headerlink" href="#constants-and-default-parameter-values" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># grid defaults</span>
<span class="n">N_ROWS</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">N_COLS</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">N_CELLS</span> <span class="o">=</span> <span class="n">N_ROWS</span> <span class="o">*</span> <span class="n">N_COLS</span>

<span class="c1"># coder language constants</span>
<span class="n">LANG_PYTHON</span> <span class="o">=</span> <span class="s1">&#39;PYTHON&#39;</span>
<span class="n">LANG_R</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>

<span class="c1"># default simulation parameters</span>
<span class="n">RATIO_R_TO_PYTHON</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">PERCENT_EMPTY</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">SIMILARITY_THRESHOLD</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">MAX_ITER</span> <span class="o">=</span> <span class="mi">500</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-datascientist-class">
<h2>The <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code> class<a class="headerlink" href="#the-datascientist-class" title="Permalink to this headline">¶</a></h2>
<p>When creating a new <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code> we will use the following syntax</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create an new data scientist agent that prefers python</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">DataScientist</span><span class="p">(</span><span class="n">unique_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">LANG_PYTHON</span><span class="p">,</span> 
                      <span class="n">env</span><span class="o">=</span><span class="n">grid_env</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">SIMILARITY_THRESHOLD</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>In the above code snippet <code class="docutils literal notranslate"><span class="pre">grid_env</span></code> is an instance of the <code class="docutils literal notranslate"><span class="pre">GridWorld</span></code> class that an agent lives and interacts with other agents.</p>
</div></blockquote>
<p>As you have already learned <code class="docutils literal notranslate"><span class="pre">agent</span></code> is an instance of the class <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code>.  At this stage all the code has done is parameterise the agent and position it in the grid environment.  The code below demonstrates how you would store these parameters as class attributes using <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DataScientist</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unqiue_id</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span>
                 <span class="n">threshold</span><span class="o">=</span><span class="n">SIMILARITY_THRESHOLD</span><span class="p">):</span>
        <span class="c1"># store the class attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique_id</span> <span class="o">=</span> <span class="n">unique_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row</span> <span class="o">=</span> <span class="n">row</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">language</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        
        
    <span class="k">def</span> <span class="nf">is_unsatisified_with_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>The only public method that <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code> makes available is <code class="docutils literal notranslate"><span class="pre">is_unsatisified_with_neighbours()</span></code>.  For the agent to makes its decision it must first gather its neighbours.  This can be done by calling <code class="docutils literal notranslate"><span class="pre">GridWorld.get_neighbours(row,</span> <span class="pre">col)</span></code>.  A <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code> agent contains the attribute <code class="docutils literal notranslate"><span class="pre">self.env</span></code> which is a reference to the grid world.  You can therefore access the agent’s neighbours like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">neighbours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
<p>We haven’t implemented the <code class="docutils literal notranslate"><span class="pre">GridWorld</span></code> class yet, but for now you can note that <code class="docutils literal notranslate"><span class="pre">get_neighbours</span></code> returns a <code class="docutils literal notranslate"><span class="pre">list</span></code> of <code class="docutils literal notranslate"><span class="pre">DataScientist</span></code> objects that live in the neighbouring cells to the agent. Note this list is of variable length and depending on the number of empty cells next to an agent. From here is straightforward to calculate the percentage of neighbours that use the same coding language.  As an example code could:</p>
<ul class="simple">
<li><p>Calculate the number of neighbours by taking the <code class="docutils literal notranslate"><span class="pre">len</span></code> of the returned list.</p></li>
<li><p>Calculate the number of similar neighbours using a loop or list comprehension.</p></li>
<li><p>Check for the special case where the number of neighbours is zero and return False.</p></li>
<li><p>Calculate the proportion of similar neighbours and check if this is less than the agent’s similarity threshold.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DataScientist</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unqiue_id</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span>
                 <span class="n">threshold</span><span class="o">=</span><span class="n">SIMILARITY_THRESHOLD</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique_id</span> <span class="o">=</span> <span class="n">unique_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row</span> <span class="o">=</span> <span class="n">row</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="n">col</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">language</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        
        
    <span class="k">def</span> <span class="nf">is_unsatisified_with_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DataScientist</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unqiue_id</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span>
                 <span class="n">threshold</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">is_unsatisified_with_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "health-data-science-OR/coding-for-ml",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/01_algorithms/labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../lecture/01_python_classes.html" title="previous page">An introduction to OOP</a>
    <a class='right-next' id="next-link" href="../../02_numpy/02_lectures_front_page.html" title="next page">Lecture notes</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Thomas Monks<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>